{"version":3,"file":"CalendarGuiUtils.js","sourceRoot":"","sources":["../../../../../src/calendar-app/calendar/gui/CalendarGuiUtils.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Child, ChildArray, Children } from \"mithril\"\nimport type { TranslationKey } from \"../../../common/misc/LanguageViewModel.js\"\nimport { lang } from \"../../../common/misc/LanguageViewModel.js\"\nimport { ButtonType } from \"../../../common/gui/base/Button.js\"\nimport { Icons } from \"../../../common/gui/base/icons/Icons.js\"\nimport { Dialog } from \"../../../common/gui/base/Dialog.js\"\nimport type { MousePosAndBounds } from \"../../../common/gui/base/GuiUtils.js\"\nimport { Time } from \"../../../common/calendar/date/Time.js\"\nimport {\n\tassert,\n\tassertNotNull,\n\tclamp,\n\tclone,\n\tgetFromMap,\n\tgetStartOfDay,\n\tincrementDate,\n\tisNotEmpty,\n\tisSameDay,\n\tisSameDayOfDate,\n\tmemoized,\n\tnumberRange,\n\ttypedValues,\n} from \"@tutao/tutanota-utils\"\nimport { IconButton } from \"../../../common/gui/base/IconButton.js\"\nimport {\n\tformatDateTime,\n\tformatDateWithMonth,\n\tformatDateWithWeekday,\n\tformatMonthWithFullYear,\n\tformatTime,\n\ttimeStringFromParts,\n} from \"../../../common/misc/Formatter.js\"\nimport {\n\tAlarmInterval,\n\talarmIntervalToLuxonDurationLikeObject,\n\tAlarmIntervalUnit,\n\tCalendarDay,\n\tCalendarMonth,\n\teventEndsAfterDay,\n\teventStartsBefore,\n\tgetAllDayDateForTimezone,\n\tgetEndOfDayWithZone,\n\tgetEventEnd,\n\tgetEventStart,\n\tgetStartOfDayWithZone,\n\tgetStartOfNextDayWithZone,\n\tgetStartOfTheWeekOffset,\n\tgetStartOfWeek,\n\tgetTimeZone,\n\tgetWeekNumber,\n\tincrementByRepeatPeriod,\n\tStandardAlarmInterval,\n} from \"../../../common/calendar/date/CalendarUtils.js\"\nimport {\n\tAccountType,\n\tCalendarAttendeeStatus,\n\tCLIENT_ONLY_CALENDARS,\n\tDEFAULT_CLIENT_ONLY_CALENDAR_COLORS,\n\tdefaultCalendarColor,\n\tEndType,\n\tEventTextTimeOption,\n\tRepeatPeriod,\n\tShareCapability,\n\tWeekStart,\n} from \"../../../common/api/common/TutanotaConstants.js\"\nimport { AllIcons } from \"../../../common/gui/base/Icon.js\"\nimport { SelectorItemList } from \"../../../common/gui/base/DropDownSelector.js\"\nimport { DateTime, Duration } from \"luxon\"\nimport { CalendarEventTimes, CalendarViewType, cleanMailAddress, isAllDayEvent } from \"../../../common/api/common/utils/CommonCalendarUtils.js\"\nimport { CalendarEvent, UserSettingsGroupRoot } from \"../../../common/api/entities/tutanota/TypeRefs.js\"\nimport { ProgrammingError } from \"../../../common/api/common/error/ProgrammingError.js\"\nimport { size } from \"../../../common/gui/size.js\"\nimport { hslToHex, isColorLight, isValidColorCode, MAX_HUE_ANGLE } from \"../../../common/gui/base/Color.js\"\nimport { GroupColors } from \"../view/CalendarView.js\"\nimport { CalendarInfo } from \"../model/CalendarModel.js\"\nimport { EventType } from \"./eventeditor-model/CalendarEventModel.js\"\nimport { hasCapabilityOnGroup } from \"../../../common/sharing/GroupUtils.js\"\nimport { EventsOnDays } from \"../view/CalendarViewModel.js\"\nimport { CalendarEventPreviewViewModel } from \"./eventpopup/CalendarEventPreviewViewModel.js\"\nimport { createAsyncDropdown } from \"../../../common/gui/base/Dropdown.js\"\nimport { UserController } from \"../../../common/api/main/UserController.js\"\nimport { ClientOnlyCalendarsInfo } from \"../../../common/misc/DeviceConfig.js\"\nimport { SelectOption } from \"../../../common/gui/base/Select.js\"\nimport { RadioGroupOption } from \"../../../common/gui/base/RadioGroup.js\"\nimport { ColorPickerModel } from \"../../../common/gui/base/colorPicker/ColorPickerModel.js\"\nimport { theme } from \"../../../common/gui/theme.js\"\n\nexport interface IntervalOption {\n\tvalue: number\n\tariaValue: string\n\tname: string\n}\n\nexport function renderCalendarSwitchLeftButton(label: TranslationKey, click: () => unknown): Child {\n\treturn m(IconButton, {\n\t\ttitle: label,\n\t\ticon: Icons.ArrowBackward,\n\t\tclick,\n\t})\n}\n\nexport function renderCalendarSwitchRightButton(label: TranslationKey, click: () => unknown): Child {\n\treturn m(IconButton, {\n\t\ttitle: label,\n\t\ticon: Icons.ArrowForward,\n\t\tclick,\n\t})\n}\n\nfunction weekTitle(date: Date, weekStart: WeekStart): string {\n\tconst startOfTheWeekOffset = getStartOfTheWeekOffset(weekStart)\n\tconst firstDate = getStartOfWeek(date, startOfTheWeekOffset)\n\tconst lastDate = incrementDate(new Date(firstDate), 6)\n\n\tif (firstDate.getMonth() !== lastDate.getMonth()) {\n\t\tif (firstDate.getFullYear() !== lastDate.getFullYear()) {\n\t\t\treturn `${lang.formats.monthShortWithFullYear.format(firstDate)} - ${lang.formats.monthShortWithFullYear.format(lastDate)}`\n\t\t}\n\t\treturn `${lang.formats.monthShort.format(firstDate)} - ${lang.formats.monthShort.format(lastDate)} ${lang.formats.yearNumeric.format(firstDate)}`\n\t} else {\n\t\treturn `${lang.formats.monthLong.format(firstDate)} ${lang.formats.yearNumeric.format(firstDate)}`\n\t}\n}\n\nexport function getNextFourteenDays(startOfToday: Date): Array<Date> {\n\tlet calculationDate = new Date(startOfToday)\n\tconst days: Date[] = []\n\n\tfor (let i = 0; i < 14; i++) {\n\t\tdays.push(new Date(calculationDate.getTime()))\n\t\tcalculationDate = incrementDate(calculationDate, 1)\n\t}\n\n\treturn days\n}\n\nexport type CalendarNavConfiguration = { back: Child; title: string; forward: Child }\n\nexport function calendarWeek(date: Date, weekStart: WeekStart) {\n\t// According to ISO 8601, weeks always start on Monday. Week numbering systems for\n\t// weeks that do not start on Monday are not strictly defined, so we only display\n\t// a week number if the user's client is configured to start weeks on Monday\n\tif (weekStart !== WeekStart.MONDAY) {\n\t\treturn null\n\t}\n\n\treturn lang.get(\"weekNumber_label\", {\n\t\t\"{week}\": String(getWeekNumber(date)),\n\t})\n}\n\nexport function calendarNavConfiguration(\n\tviewType: CalendarViewType,\n\tdate: Date,\n\tweekStart: WeekStart,\n\ttitleType: \"short\" | \"detailed\",\n\tswitcher: (viewType: CalendarViewType, next: boolean) => unknown,\n): CalendarNavConfiguration {\n\tconst onBack = () => switcher(viewType, false)\n\tconst onForward = () => switcher(viewType, true)\n\tswitch (viewType) {\n\t\tcase CalendarViewType.DAY:\n\t\t\treturn {\n\t\t\t\tback: renderCalendarSwitchLeftButton(\"prevDay_label\", onBack),\n\t\t\t\tforward: renderCalendarSwitchRightButton(\"nextDay_label\", onForward),\n\t\t\t\ttitle: titleType === \"short\" ? formatMonthWithFullYear(date) : formatDateWithWeekday(date),\n\t\t\t}\n\t\tcase CalendarViewType.MONTH:\n\t\t\treturn {\n\t\t\t\tback: renderCalendarSwitchLeftButton(\"prevMonth_label\", onBack),\n\t\t\t\tforward: renderCalendarSwitchRightButton(\"nextMonth_label\", onForward),\n\t\t\t\ttitle: formatMonthWithFullYear(date),\n\t\t\t}\n\t\tcase CalendarViewType.WEEK:\n\t\t\treturn {\n\t\t\t\tback: renderCalendarSwitchLeftButton(\"prevWeek_label\", onBack),\n\t\t\t\tforward: renderCalendarSwitchRightButton(\"nextWeek_label\", onForward),\n\t\t\t\ttitle: titleType === \"short\" ? formatMonthWithFullYear(date) : weekTitle(date, weekStart),\n\t\t\t}\n\t\tcase CalendarViewType.AGENDA:\n\t\t\treturn {\n\t\t\t\tback: renderCalendarSwitchLeftButton(\"prevDay_label\", onBack),\n\t\t\t\tforward: renderCalendarSwitchRightButton(\"nextDay_label\", onForward),\n\t\t\t\ttitle: titleType === \"short\" ? formatMonthWithFullYear(date) : formatDateWithWeekday(date),\n\t\t\t}\n\t}\n}\n\nexport function askIfShouldSendCalendarUpdatesToAttendees(): Promise<\"yes\" | \"no\" | \"cancel\"> {\n\treturn new Promise((resolve) => {\n\t\tlet alertDialog: Dialog\n\t\tconst cancelButton = {\n\t\t\tlabel: \"cancel_action\",\n\t\t\tclick: () => {\n\t\t\t\tresolve(\"cancel\")\n\t\t\t\talertDialog.close()\n\t\t\t},\n\t\t\ttype: ButtonType.Secondary,\n\t\t} as const\n\t\tconst noButton = {\n\t\t\tlabel: \"no_label\",\n\t\t\tclick: () => {\n\t\t\t\tresolve(\"no\")\n\t\t\t\talertDialog.close()\n\t\t\t},\n\t\t\ttype: ButtonType.Secondary,\n\t\t} as const\n\t\tconst yesButton = {\n\t\t\tlabel: \"yes_label\",\n\t\t\tclick: () => {\n\t\t\t\tresolve(\"yes\")\n\t\t\t\talertDialog.close()\n\t\t\t},\n\t\t\ttype: ButtonType.Primary,\n\t\t} as const\n\n\t\tconst onclose = (positive: boolean) => (positive ? resolve(\"yes\") : resolve(\"cancel\"))\n\n\t\talertDialog = Dialog.confirmMultiple(\"sendUpdates_msg\", [cancelButton, noButton, yesButton], onclose)\n\t})\n}\n\n/**\n * Map the location of a mouse click on an element to a give date, given a list of weeks\n * there should be neither zero weeks, nor zero length weeks\n */\nexport function getDateFromMousePos({ x, y, targetWidth, targetHeight }: MousePosAndBounds, weeks: Array<Array<Date>>): Date {\n\tassert(weeks.length > 0, \"Weeks must not be zero length\")\n\tconst unitHeight = targetHeight / weeks.length\n\tconst currentSquareY = Math.floor(y / unitHeight)\n\tconst week = weeks[clamp(currentSquareY, 0, weeks.length - 1)]\n\tassert(week.length > 0, \"Week must not be zero length\")\n\tconst unitWidth = targetWidth / week.length\n\tconst currentSquareX = Math.floor(x / unitWidth)\n\treturn week[clamp(currentSquareX, 0, week.length - 1)]\n}\n\n/**\n * Map the vertical position of a mouse click on an element to a time of day\n * @param y\n * @param targetHeight\n * @param hourDivision: how many times to divide the hour\n */\nexport function getTimeFromMousePos({ y, targetHeight }: MousePosAndBounds, hourDivision: number): Time {\n\tconst sectionHeight = targetHeight / 24\n\tconst hour = y / sectionHeight\n\tconst hourRounded = Math.floor(hour)\n\tconst minutesInc = 60 / hourDivision\n\tconst minute = Math.floor((hour - hourRounded) * hourDivision) * minutesInc\n\treturn new Time(hourRounded, minute)\n}\n\nexport const SELECTED_DATE_INDICATOR_THICKNESS = 4\n\nexport function getIconForViewType(viewType: CalendarViewType): AllIcons {\n\tconst lookupTable: Record<CalendarViewType, AllIcons> = {\n\t\t[CalendarViewType.DAY]: Icons.TableSingle,\n\t\t[CalendarViewType.WEEK]: Icons.TableColumns,\n\t\t[CalendarViewType.MONTH]: Icons.Table,\n\t\t[CalendarViewType.AGENDA]: Icons.ListUnordered,\n\t}\n\treturn lookupTable[viewType]\n}\n\nexport function shouldDefaultToAmPmTimeFormat(): boolean {\n\treturn lang.code === \"en\"\n}\n\n/**\n * get an object representing the calendar month the given date is in.\n */\nexport function getCalendarMonth(date: Date, firstDayOfWeekFromOffset: number, weekdayNarrowFormat: boolean): CalendarMonth {\n\tconst weeks: Array<Array<CalendarDay>> = [[]]\n\tconst calculationDate = getStartOfDay(date)\n\tcalculationDate.setDate(1)\n\tconst beginningOfMonth = new Date(calculationDate)\n\tlet currentYear = calculationDate.getFullYear()\n\tlet month = calculationDate.getMonth()\n\t// add \"padding\" days\n\t// getDay returns the day of the week (from 0 to 6) for the specified date (with first one being Sunday)\n\tlet firstDay\n\n\tif (firstDayOfWeekFromOffset > calculationDate.getDay()) {\n\t\tfirstDay = calculationDate.getDay() + 7 - firstDayOfWeekFromOffset\n\t} else {\n\t\tfirstDay = calculationDate.getDay() - firstDayOfWeekFromOffset\n\t}\n\n\tlet dayCount\n\tincrementDate(calculationDate, -firstDay)\n\n\tfor (dayCount = 0; dayCount < firstDay; dayCount++) {\n\t\tweeks[0].push({\n\t\t\tdate: new Date(calculationDate),\n\t\t\tday: calculationDate.getDate(),\n\t\t\tmonth: calculationDate.getMonth(),\n\t\t\tyear: calculationDate.getFullYear(),\n\t\t\tisPaddingDay: true,\n\t\t})\n\t\tincrementDate(calculationDate, 1)\n\t}\n\n\t// add actual days\n\twhile (calculationDate.getMonth() === month) {\n\t\tif (weeks[0].length && dayCount % 7 === 0) {\n\t\t\t// start new week\n\t\t\tweeks.push([])\n\t\t}\n\n\t\tconst dayInfo = {\n\t\t\tdate: new Date(currentYear, month, calculationDate.getDate()),\n\t\t\tyear: currentYear,\n\t\t\tmonth: month,\n\t\t\tday: calculationDate.getDate(),\n\t\t\tisPaddingDay: false,\n\t\t}\n\t\tweeks[weeks.length - 1].push(dayInfo)\n\t\tincrementDate(calculationDate, 1)\n\t\tdayCount++\n\t}\n\n\t// add remaining \"padding\" days\n\twhile (dayCount < 42) {\n\t\tif (dayCount % 7 === 0) {\n\t\t\tweeks.push([])\n\t\t}\n\n\t\tweeks[weeks.length - 1].push({\n\t\t\tday: calculationDate.getDate(),\n\t\t\tyear: calculationDate.getFullYear(),\n\t\t\tmonth: calculationDate.getMonth(),\n\t\t\tdate: new Date(calculationDate),\n\t\t\tisPaddingDay: true,\n\t\t})\n\t\tincrementDate(calculationDate, 1)\n\t\tdayCount++\n\t}\n\n\tconst weekdays: string[] = []\n\tconst weekdaysDate = new Date()\n\tincrementDate(weekdaysDate, -weekdaysDate.getDay() + firstDayOfWeekFromOffset) // get first day of week\n\n\tfor (let i = 0; i < 7; i++) {\n\t\tweekdays.push(weekdayNarrowFormat ? lang.formats.weekdayNarrow.format(weekdaysDate) : lang.formats.weekdayShort.format(weekdaysDate))\n\t\tincrementDate(weekdaysDate, 1)\n\t}\n\n\treturn {\n\t\tbeginningOfMonth,\n\t\tweekdays,\n\t\tweeks,\n\t}\n}\n\nexport function formatEventDuration(event: CalendarEventTimes, zone: string, includeTimezone: boolean): string {\n\tif (isAllDayEvent(event)) {\n\t\tconst startTime = getEventStart(event, zone)\n\t\tconst startString = formatDateWithMonth(startTime)\n\t\tconst endTime = incrementByRepeatPeriod(getEventEnd(event, zone), RepeatPeriod.DAILY, -1, zone)\n\n\t\tif (isSameDayOfDate(startTime, endTime)) {\n\t\t\treturn `${lang.get(\"allDay_label\")}, ${startString}`\n\t\t} else {\n\t\t\treturn `${lang.get(\"allDay_label\")}, ${startString} - ${formatDateWithMonth(endTime)}`\n\t\t}\n\t} else {\n\t\tconst startString = formatDateTime(event.startTime)\n\t\tlet endString\n\n\t\tif (isSameDay(event.startTime, event.endTime)) {\n\t\t\tendString = formatTime(event.endTime)\n\t\t} else {\n\t\t\tendString = formatDateTime(event.endTime)\n\t\t}\n\n\t\treturn `${startString} - ${endString} ${includeTimezone ? getTimeZone() : \"\"}`\n\t}\n}\n\nexport const createRepeatRuleFrequencyValues = (): SelectorItemList<RepeatPeriod | null> => {\n\treturn [\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatIntervalNoRepeat_label\"),\n\t\t\tvalue: null,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatIntervalDaily_label\"),\n\t\t\tvalue: RepeatPeriod.DAILY,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatIntervalWeekly_label\"),\n\t\t\tvalue: RepeatPeriod.WEEKLY,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatIntervalMonthly_label\"),\n\t\t\tvalue: RepeatPeriod.MONTHLY,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatIntervalAnnually_label\"),\n\t\t\tvalue: RepeatPeriod.ANNUALLY,\n\t\t},\n\t]\n}\nexport const createRepeatRuleOptions = (): ReadonlyArray<RadioGroupOption<RepeatPeriod | \"CUSTOM\" | null>> => {\n\treturn [\n\t\t{\n\t\t\tname: \"calendarRepeatIntervalNoRepeat_label\",\n\t\t\tvalue: null,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatIntervalDaily_label\",\n\t\t\tvalue: RepeatPeriod.DAILY,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatIntervalWeekly_label\",\n\t\t\tvalue: RepeatPeriod.WEEKLY,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatIntervalMonthly_label\",\n\t\t\tvalue: RepeatPeriod.MONTHLY,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatIntervalAnnually_label\",\n\t\t\tvalue: RepeatPeriod.ANNUALLY,\n\t\t},\n\t\t{\n\t\t\tname: \"custom_label\",\n\t\t\tvalue: \"CUSTOM\",\n\t\t},\n\t]\n}\n\nexport const customFrequenciesOptions = [\n\t{\n\t\tname: { singular: \"day_label\", plural: \"days_label\" },\n\t\tvalue: RepeatPeriod.DAILY,\n\t},\n\t{\n\t\tname: { singular: \"week_label\", plural: \"weeks_label\" },\n\t\tvalue: RepeatPeriod.WEEKLY,\n\t},\n\t{\n\t\tname: { singular: \"month_label\", plural: \"months_label\" },\n\t\tvalue: RepeatPeriod.MONTHLY,\n\t},\n\t{\n\t\tname: { singular: \"year_label\", plural: \"years_label\" },\n\t\tvalue: RepeatPeriod.ANNUALLY,\n\t},\n]\n\nexport const createCustomEndTypeOptions = (): ReadonlyArray<RadioGroupOption<EndType>> => {\n\treturn [\n\t\t{\n\t\t\tname: \"calendarRepeatStopConditionNever_label\",\n\t\t\tvalue: EndType.Never,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatStopConditionOccurrences_label\",\n\t\t\tvalue: EndType.Count,\n\t\t},\n\t\t{\n\t\t\tname: \"calendarRepeatStopConditionDate_label\",\n\t\t\tvalue: EndType.UntilDate,\n\t\t},\n\t]\n}\n\nexport const createRepeatRuleEndTypeValues = (): SelectorItemList<EndType> => {\n\treturn [\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatStopConditionNever_label\"),\n\t\t\tvalue: EndType.Never,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatStopConditionOccurrences_label\"),\n\t\t\tvalue: EndType.Count,\n\t\t},\n\t\t{\n\t\t\tname: lang.get(\"calendarRepeatStopConditionDate_label\"),\n\t\t\tvalue: EndType.UntilDate,\n\t\t},\n\t]\n}\nexport const createIntervalValues = (): IntervalOption[] => numberRange(1, 256).map((n) => ({ name: String(n), value: n, ariaValue: String(n) }))\n\nexport function humanDescriptionForAlarmInterval<P>(value: AlarmInterval, locale: string): string {\n\tif (value.value === 0) return lang.get(\"calendarReminderIntervalAtEventStart_label\")\n\n\treturn Duration.fromObject(alarmIntervalToLuxonDurationLikeObject(value)).reconfigure({ locale: locale }).toHuman()\n}\n\nexport const createAlarmIntervalItems = (locale: string): SelectorItemList<AlarmInterval> =>\n\ttypedValues(StandardAlarmInterval).map((value) => {\n\t\treturn {\n\t\t\tvalue,\n\t\t\tname: humanDescriptionForAlarmInterval(value, locale),\n\t\t}\n\t})\n\nexport interface AttendingItem extends SelectOption<CalendarAttendeeStatus> {\n\tname: string\n\tselectable?: boolean\n}\n\nexport const createAttendingItems = (): AttendingItem[] => [\n\t{\n\t\tname: lang.get(\"attending_label\"),\n\t\tvalue: CalendarAttendeeStatus.ACCEPTED,\n\t\tariaValue: lang.get(\"attending_label\"),\n\t},\n\t{\n\t\tname: lang.get(\"maybeAttending_label\"),\n\t\tvalue: CalendarAttendeeStatus.TENTATIVE,\n\t\tariaValue: lang.get(\"maybeAttending_label\"),\n\t},\n\t{\n\t\tname: lang.get(\"notAttending_label\"),\n\t\tvalue: CalendarAttendeeStatus.DECLINED,\n\t\tariaValue: lang.get(\"notAttending_label\"),\n\t},\n\t{\n\t\tname: lang.get(\"pending_label\"),\n\t\tvalue: CalendarAttendeeStatus.NEEDS_ACTION,\n\t\tselectable: false,\n\t\tariaValue: lang.get(\"pending_label\"),\n\t},\n]\n\nexport function humanDescriptionForAlarmIntervalUnit(unit: AlarmIntervalUnit): string {\n\tswitch (unit) {\n\t\tcase AlarmIntervalUnit.MINUTE:\n\t\t\treturn lang.get(\"calendarReminderIntervalUnitMinutes_label\")\n\t\tcase AlarmIntervalUnit.HOUR:\n\t\t\treturn lang.get(\"calendarReminderIntervalUnitHours_label\")\n\t\tcase AlarmIntervalUnit.DAY:\n\t\t\treturn lang.get(\"calendarReminderIntervalUnitDays_label\")\n\t\tcase AlarmIntervalUnit.WEEK:\n\t\t\treturn lang.get(\"calendarReminderIntervalUnitWeeks_label\")\n\t}\n}\n\nexport function timeString(date: Date, amPm: boolean): string {\n\treturn timeStringFromParts(date.getHours(), date.getMinutes(), amPm)\n}\n\nexport function timeStringInZone(date: Date, amPm: boolean, zone: string): string {\n\tconst { hour, minute } = DateTime.fromJSDate(date, {\n\t\tzone,\n\t})\n\treturn timeStringFromParts(hour, minute, amPm)\n}\n\nexport function formatEventTime({ endTime, startTime }: CalendarEventTimes, showTime: EventTextTimeOption): string {\n\tswitch (showTime) {\n\t\tcase EventTextTimeOption.START_TIME:\n\t\t\treturn formatTime(startTime)\n\n\t\tcase EventTextTimeOption.END_TIME:\n\t\t\treturn ` - ${formatTime(endTime)}`\n\n\t\tcase EventTextTimeOption.START_END_TIME:\n\t\t\treturn `${formatTime(startTime)} - ${formatTime(endTime)}`\n\n\t\tdefault:\n\t\t\tthrow new ProgrammingError(`Unknown time option: ${showTime}`)\n\t}\n}\n\nexport function formatEventTimes(day: Date, event: CalendarEvent, zone: string): string {\n\tif (isAllDayEvent(event)) {\n\t\treturn lang.get(\"allDay_label\")\n\t} else {\n\t\tconst startsBefore = eventStartsBefore(day, zone, event)\n\t\tconst endsAfter = eventEndsAfterDay(day, zone, event)\n\t\tif (startsBefore && endsAfter) {\n\t\t\treturn lang.get(\"allDay_label\")\n\t\t} else {\n\t\t\tconst startTime: Date = startsBefore ? day : event.startTime\n\t\t\tconst endTime: Date = endsAfter ? getEndOfDayWithZone(day, zone) : event.endTime\n\t\t\treturn formatEventTime({ startTime, endTime }, EventTextTimeOption.START_END_TIME)\n\t\t}\n\t}\n}\n\nexport const createCustomRepeatRuleUnitValues = (): SelectorItemList<AlarmIntervalUnit | null> => {\n\treturn [\n\t\t{\n\t\t\tname: humanDescriptionForAlarmIntervalUnit(AlarmIntervalUnit.MINUTE),\n\t\t\tvalue: AlarmIntervalUnit.MINUTE,\n\t\t},\n\t\t{\n\t\t\tname: humanDescriptionForAlarmIntervalUnit(AlarmIntervalUnit.HOUR),\n\t\t\tvalue: AlarmIntervalUnit.HOUR,\n\t\t},\n\t\t{\n\t\t\tname: humanDescriptionForAlarmIntervalUnit(AlarmIntervalUnit.DAY),\n\t\t\tvalue: AlarmIntervalUnit.DAY,\n\t\t},\n\t\t{\n\t\t\tname: humanDescriptionForAlarmIntervalUnit(AlarmIntervalUnit.WEEK),\n\t\t\tvalue: AlarmIntervalUnit.WEEK,\n\t\t},\n\t]\n}\nexport const CALENDAR_EVENT_HEIGHT: number = size.calendar_line_height + 2\nexport const TEMPORARY_EVENT_OPACITY = 0.7\n\nexport const enum EventLayoutMode {\n\t/** Take event start and end times into account when laying out. */\n\tTimeBasedColumn,\n\t/** Each event is treated as if it would take the whole day when laying out. */\n\tDayBasedColumn,\n}\n\n/**\n * Function which sorts events into the \"columns\" and \"rows\" and renders them using {@param renderer}.\n * Columns are abstract and can be actually the rows. A single column progresses in time while multiple columns can happen in parallel.\n * in one column on a single day (it will \"stretch\" events from the day start until the next day).\n */\nexport function layOutEvents(\n\tevents: Array<CalendarEvent>,\n\tzone: string,\n\trenderer: (columns: Array<Array<CalendarEvent>>) => ChildArray,\n\tlayoutMode: EventLayoutMode,\n): ChildArray {\n\tevents.sort((e1, e2) => {\n\t\tconst e1Start = getEventStart(e1, zone)\n\t\tconst e2Start = getEventStart(e2, zone)\n\t\tif (e1Start < e2Start) return -1\n\t\tif (e1Start > e2Start) return 1\n\t\tconst e1End = getEventEnd(e1, zone)\n\t\tconst e2End = getEventEnd(e2, zone)\n\t\tif (e1End < e2End) return -1\n\t\tif (e1End > e2End) return 1\n\t\treturn 0\n\t})\n\tlet lastEventEnding: Date | null = null\n\tlet lastEventStart: Date | null = null\n\tlet columns: Array<Array<CalendarEvent>> = []\n\tconst children: Array<Children> = []\n\t// Cache for calculation events\n\tconst calcEvents = new Map()\n\tfor (const e of events) {\n\t\tconst calcEvent = getFromMap(calcEvents, e, () => getCalculationEvent(e, zone, layoutMode))\n\t\t// Check if a new event group needs to be started\n\t\tif (\n\t\t\tlastEventEnding != null &&\n\t\t\tlastEventStart != null &&\n\t\t\tlastEventEnding <= calcEvent.startTime.getTime() &&\n\t\t\t(layoutMode === EventLayoutMode.DayBasedColumn || !visuallyOverlaps(lastEventStart, lastEventEnding, calcEvent.startTime))\n\t\t) {\n\t\t\t// The latest event is later than any of the event in the\n\t\t\t// current group. There is no overlap. Output the current\n\t\t\t// event group and start a new event group.\n\t\t\tchildren.push(...renderer(columns))\n\t\t\tcolumns = [] // This starts new event group.\n\n\t\t\tlastEventEnding = null\n\t\t\tlastEventStart = null\n\t\t}\n\n\t\t// Try to place the event inside the existing columns\n\t\tlet placed = false\n\n\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\tconst col = columns[i]\n\t\t\tconst lastEvent = col[col.length - 1]\n\t\t\tconst lastCalcEvent = getFromMap(calcEvents, lastEvent, () => getCalculationEvent(lastEvent, zone, layoutMode))\n\n\t\t\tif (\n\t\t\t\t!collidesWith(lastCalcEvent, calcEvent) &&\n\t\t\t\t(layoutMode === EventLayoutMode.DayBasedColumn || !visuallyOverlaps(lastCalcEvent.startTime, lastCalcEvent.endTime, calcEvent.startTime))\n\t\t\t) {\n\t\t\t\tcol.push(e) // push real event here not calc event\n\n\t\t\t\tplaced = true\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// It was not possible to place the event. Add a new column\n\t\t// for the current event group.\n\t\tif (!placed) {\n\t\t\tcolumns.push([e])\n\t\t}\n\n\t\t// Remember the latest event end time and start time of the current group.\n\t\t// This is later used to determine if a new groups starts.\n\t\tif (lastEventEnding == null || lastEventEnding.getTime() < calcEvent.endTime.getTime()) {\n\t\t\tlastEventEnding = calcEvent.endTime\n\t\t}\n\t\tif (lastEventStart == null || lastEventStart.getTime() < calcEvent.startTime.getTime()) {\n\t\t\tlastEventStart = calcEvent.startTime\n\t\t}\n\t}\n\tchildren.push(...renderer(columns))\n\treturn children\n}\n\n/** get an event that can be rendered to the screen. in day view, the event is returned as-is, otherwise it's stretched to cover each day\n * it occurs on completely. */\nfunction getCalculationEvent(event: CalendarEvent, zone: string, eventLayoutMode: EventLayoutMode): CalendarEvent {\n\tif (eventLayoutMode === EventLayoutMode.DayBasedColumn) {\n\t\tconst calcEvent = clone(event)\n\n\t\tif (isAllDayEvent(event)) {\n\t\t\tcalcEvent.startTime = getAllDayDateForTimezone(event.startTime, zone)\n\t\t\tcalcEvent.endTime = getAllDayDateForTimezone(event.endTime, zone)\n\t\t} else {\n\t\t\tcalcEvent.startTime = getStartOfDayWithZone(event.startTime, zone)\n\t\t\tcalcEvent.endTime = getStartOfNextDayWithZone(event.endTime, zone)\n\t\t}\n\n\t\treturn calcEvent\n\t} else {\n\t\treturn event\n\t}\n}\n\n/**\n * This function checks whether two events collide based on their start and end time\n * Assuming vertical columns with time going top-to-bottom, this would be true in these cases:\n *\n * case 1:\n * +-----------+\n * |           |\n * |           |   +----------+\n * +-----------+   |          |\n *                 |          |\n *                 +----------+\n * case 2:\n * +-----------+\n * |           |   +----------+\n * |           |   |          |\n * |           |   +----------+\n * +-----------+\n *\n * There could be a case where they are flipped vertically, but we don't have them because earlier events will be always first. so the \"left\" top edge will\n * always be \"above\" the \"right\" top edge.\n */\nfunction collidesWith(a: CalendarEvent, b: CalendarEvent): boolean {\n\treturn a.endTime.getTime() > b.startTime.getTime() && a.startTime.getTime() < b.endTime.getTime()\n}\n\n/**\n * Due to the minimum height for events they overlap if a short event is directly followed by another event,\n * therefore, we check whether the event height is less than the minimum height.\n *\n * This does not cover all the cases but handles the case when the second event starts right after the first one.\n */\nfunction visuallyOverlaps(firstEventStart: Date, firstEventEnd: Date, secondEventStart: Date): boolean {\n\t// We are only interested in the height on the last day of the event because an event ending later will take up the whole column until the next day anyway.\n\tconst firstEventStartOnSameDay = isSameDay(firstEventStart, firstEventEnd) ? firstEventStart.getTime() : getStartOfDay(firstEventEnd).getTime()\n\tconst eventDurationMs = firstEventEnd.getTime() - firstEventStartOnSameDay\n\tconst eventDurationHours = eventDurationMs / (1000 * 60 * 60)\n\tconst height = eventDurationHours * size.calendar_hour_height - size.calendar_event_border\n\treturn firstEventEnd.getTime() === secondEventStart.getTime() && height < size.calendar_line_height\n}\n\nexport function expandEvent(ev: CalendarEvent, columnIndex: number, columns: Array<Array<CalendarEvent>>): number {\n\tlet colSpan = 1\n\n\tfor (let i = columnIndex + 1; i < columns.length; i++) {\n\t\tlet col = columns[i]\n\n\t\tfor (let j = 0; j < col.length; j++) {\n\t\t\tlet ev1 = col[j]\n\n\t\t\tif (collidesWith(ev, ev1) || visuallyOverlaps(ev.startTime, ev.endTime, ev1.startTime)) {\n\t\t\t\treturn colSpan\n\t\t\t}\n\t\t}\n\n\t\tcolSpan++\n\t}\n\n\treturn colSpan\n}\n\nexport function getEventColor(event: CalendarEvent, groupColors: GroupColors): string {\n\treturn (event._ownerGroup && groupColors.get(event._ownerGroup)) ?? defaultCalendarColor\n}\n\nexport function calendarAttendeeStatusSymbol(status: CalendarAttendeeStatus): string {\n\tswitch (status) {\n\t\tcase CalendarAttendeeStatus.ADDED:\n\t\tcase CalendarAttendeeStatus.NEEDS_ACTION:\n\t\t\treturn \"\"\n\n\t\tcase CalendarAttendeeStatus.TENTATIVE:\n\t\t\treturn \"?\"\n\n\t\tcase CalendarAttendeeStatus.ACCEPTED:\n\t\t\treturn \"\"\n\n\t\tcase CalendarAttendeeStatus.DECLINED:\n\t\t\treturn \"\"\n\n\t\tdefault:\n\t\t\tthrow new Error(\"Unknown calendar attendee status: \" + status)\n\t}\n}\n\nexport const iconForAttendeeStatus: Record<CalendarAttendeeStatus, AllIcons> = Object.freeze({\n\t[CalendarAttendeeStatus.ACCEPTED]: Icons.CircleCheckmark,\n\t[CalendarAttendeeStatus.TENTATIVE]: Icons.CircleHelp,\n\t[CalendarAttendeeStatus.DECLINED]: Icons.CircleReject,\n\t[CalendarAttendeeStatus.NEEDS_ACTION]: Icons.CircleHelp,\n\t[CalendarAttendeeStatus.ADDED]: Icons.CircleHelp,\n})\nexport const getGroupColors = memoized((userSettingsGroupRoot: UserSettingsGroupRoot) => {\n\treturn userSettingsGroupRoot.groupSettings.reduce((acc, { group, color }) => {\n\t\tif (!isValidColorCode(\"#\" + color)) {\n\t\t\tcolor = defaultCalendarColor\n\t\t}\n\t\tacc.set(group, color)\n\t\treturn acc\n\t}, new Map())\n})\n\nexport const getClientOnlyColors = (userId: Id, clientOnlyCalendarsInfo: Map<Id, ClientOnlyCalendarsInfo>) => {\n\tconst colors: Map<Id, string> = new Map()\n\tfor (const [id, _] of CLIENT_ONLY_CALENDARS) {\n\t\tconst calendarId = `${userId}#${id}`\n\t\tcolors.set(calendarId, clientOnlyCalendarsInfo.get(calendarId)?.color ?? DEFAULT_CLIENT_ONLY_CALENDAR_COLORS.get(id)!)\n\t}\n\treturn colors\n}\n\nexport const getClientOnlyCalendars = (userId: Id, clientOnlyCalendarInfo: Map<Id, ClientOnlyCalendarsInfo>) => {\n\tconst userCalendars: (ClientOnlyCalendarsInfo & { id: string; name: string })[] = []\n\n\tfor (const [id, key] of CLIENT_ONLY_CALENDARS) {\n\t\tconst calendarId = `${userId}#${id}`\n\t\tconst calendar = clientOnlyCalendarInfo.get(calendarId)\n\t\tif (calendar) {\n\t\t\tuserCalendars.push({\n\t\t\t\t...calendar,\n\t\t\t\tid: calendarId,\n\t\t\t\tname: calendar.name ? calendar.name : lang.get(key),\n\t\t\t})\n\t\t}\n\t}\n\n\treturn userCalendars\n}\n\n/**\n *  find out how we ended up with this event, which determines the capabilities we have with it.\n *  for shared events in calendar where we have read-write access, we can still only view events that have\n *  attendees, because we could not send updates after we edit something\n * @param existingEvent the event in question.\n * @param calendars a list of calendars that this user has access to.\n * @param ownMailAddresses the list of mail addresses this user might be using.\n * @param userController\n */\nexport function getEventType(\n\texistingEvent: Partial<CalendarEvent>,\n\tcalendars: ReadonlyMap<Id, CalendarInfo>,\n\townMailAddresses: ReadonlyArray<string>,\n\tuserController: UserController,\n): EventType {\n\tconst { user, userSettingsGroupRoot } = userController\n\n\tif (user.accountType === AccountType.EXTERNAL) {\n\t\treturn EventType.EXTERNAL\n\t}\n\n\tconst existingOrganizer = existingEvent.organizer\n\tconst isOrganizer = existingOrganizer != null && ownMailAddresses.some((a) => cleanMailAddress(a) === existingOrganizer.address)\n\n\tif (existingEvent._ownerGroup == null) {\n\t\tif (existingOrganizer != null && !isOrganizer) {\n\t\t\t// OwnerGroup is not set for events from file, but we also require an organizer to treat it as an invite.\n\t\t\treturn EventType.INVITE\n\t\t} else {\n\t\t\t// either the organizer exists and it's us, or the organizer does not exist and we can treat this as our event,\n\t\t\t// like for newly created events.\n\t\t\treturn EventType.OWN\n\t\t}\n\t}\n\n\tconst calendarInfoForEvent = calendars.get(existingEvent._ownerGroup) ?? null\n\tif (calendarInfoForEvent == null || calendarInfoForEvent.isExternal) {\n\t\t// event has an ownergroup, but it's not in one of our calendars. this might actually be an error.\n\t\treturn EventType.SHARED_RO\n\t}\n\n\t/**\n\t * if the event has a _ownerGroup, it means there is a calendar set to it\n\t * so, if the user is the owner of said calendar they are free to manage the event however they want\n\t **/\n\tif ((isOrganizer || existingOrganizer === null) && calendarInfoForEvent.userIsOwner) {\n\t\treturn EventType.OWN\n\t}\n\n\tif (calendarInfoForEvent.shared) {\n\t\tconst canWrite = hasCapabilityOnGroup(user, calendarInfoForEvent.group, ShareCapability.Write)\n\t\tif (canWrite) {\n\t\t\tconst organizerAddress = cleanMailAddress(existingOrganizer?.address ?? \"\")\n\t\t\tconst wouldRequireUpdates: boolean =\n\t\t\t\texistingEvent.attendees != null && existingEvent.attendees.some((a) => cleanMailAddress(a.address.address) !== organizerAddress)\n\t\t\treturn wouldRequireUpdates ? EventType.LOCKED : EventType.SHARED_RW\n\t\t} else {\n\t\t\treturn EventType.SHARED_RO\n\t\t}\n\t}\n\n\t//For an event in a personal calendar there are 3 options\n\tif (existingOrganizer == null || existingEvent.attendees?.length === 0 || isOrganizer) {\n\t\t// 1. we are the organizer of the event or the event does not have an organizer yet\n\t\t// 2. we are not the organizer and the event does not have guests. it was created by someone we shared our calendar with (also considered our own event)\n\t\treturn EventType.OWN\n\t} else {\n\t\t// 3. the event is an invitation that has another organizer and/or attendees.\n\t\treturn EventType.INVITE\n\t}\n}\n\nexport function shouldDisplayEvent(e: CalendarEvent, hiddenCalendars: ReadonlySet<Id>): boolean {\n\treturn !hiddenCalendars.has(assertNotNull(e._ownerGroup, \"event without ownerGroup in getEventsOnDays\"))\n}\n\nexport function daysHaveEvents(eventsOnDays: EventsOnDays): boolean {\n\treturn eventsOnDays.shortEventsPerDay.some(isNotEmpty) || isNotEmpty(eventsOnDays.longEvents)\n}\n\n/**\n * A handler for `onwheel` to move to a forwards or previous view based on mouse wheel movement\n * @returns a function to be used by `onwheel`\n */\nexport function changePeriodOnWheel(callback: (isNext: boolean) => unknown): (event: WheelEvent) => void {\n\treturn (event: WheelEvent) => {\n\t\t// Go to the next period if scrolling down or right\n\t\tcallback(event.deltaY > 0 || event.deltaX > 0)\n\t}\n}\n\nexport async function showDeletePopup(model: CalendarEventPreviewViewModel, ev: MouseEvent, receiver: HTMLElement, onClose?: () => unknown) {\n\tif (await model.isRepeatingForDeleting()) {\n\t\tcreateAsyncDropdown({\n\t\t\tlazyButtons: () =>\n\t\t\t\tPromise.resolve([\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"deleteSingleEventRecurrence_action\",\n\t\t\t\t\t\tclick: async () => {\n\t\t\t\t\t\t\tawait model.deleteSingle()\n\t\t\t\t\t\t\tonClose?.()\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"deleteAllEventRecurrence_action\",\n\t\t\t\t\t\tclick: () => confirmDeleteClose(model, onClose),\n\t\t\t\t\t},\n\t\t\t\t]),\n\t\t\twidth: 300,\n\t\t})(ev, receiver)\n\t} else {\n\t\t// noinspection JSIgnoredPromiseFromCall\n\t\tconfirmDeleteClose(model, onClose)\n\t}\n}\n\nasync function confirmDeleteClose(model: CalendarEventPreviewViewModel, onClose?: () => unknown): Promise<void> {\n\tif (!(await Dialog.confirm(\"deleteEventConfirmation_msg\"))) return\n\tawait model.deleteAll()\n\tonClose?.()\n}\n\nexport function getDisplayEventTitle(title: string): string {\n\treturn title ?? title !== \"\" ? title : lang.get(\"noTitle_label\")\n}\n\nexport type ColorString = string\n\nexport function generateRandomColor(): ColorString {\n\tconst model = new ColorPickerModel(!isColorLight(theme.content_bg))\n\treturn hslToHex(model.getColor(Math.floor(Math.random() * MAX_HUE_ANGLE), 2))\n}\n\nexport function renderCalendarColor(selectedCalendar: CalendarInfo | null, groupColors: Map<Id, string>) {\n\tconst color = selectedCalendar ? groupColors.get(selectedCalendar.groupInfo.group) ?? defaultCalendarColor : null\n\treturn m(\".mt-xs\", {\n\t\tstyle: {\n\t\t\twidth: \"100px\",\n\t\t\theight: \"10px\",\n\t\t\tbackground: color ? \"#\" + color : \"transparent\",\n\t\t},\n\t})\n}\n"]}